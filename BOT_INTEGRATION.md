# Telegram Bot + WebApp Integration

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
tma-project/
‚îú‚îÄ‚îÄ frontend/          # –í–∞—à–µ —Ç–µ–∫—É—â–µ–µ Svelte –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (WebApp)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ bot/               # Telegram Bot (–Ω–æ–≤–∞—è –ø–∞–ø–∫–∞)
    ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îú‚îÄ‚îÄ bot.js     # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
    ‚îÇ   ‚îú‚îÄ‚îÄ database/  # –†–∞–±–æ—Ç–∞ —Å –ë–î
    ‚îÇ   ‚îú‚îÄ‚îÄ handlers/  # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
    ‚îÇ   ‚îî‚îÄ‚îÄ webApp/    # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WebApp
    ‚îú‚îÄ‚îÄ package.json
    ‚îî‚îÄ‚îÄ vercel.json    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è
```

## –ö–∞–∫ –æ–Ω–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç WebApp** –≤ Telegram
2. **WebApp –ø–æ–ª—É—á–∞–µ—Ç initData** (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ)
3. **WebApp –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É** —á–µ—Ä–µ–∑ API endpoint
4. **Bot —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ** –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
5. **Bot –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –∞–¥–º–∏–Ω–∞–º

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å—Ç–µ–∫

### Frontend (WebApp)
- ‚úÖ **SvelteKit** (–≤–∞—à —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç)
- ‚úÖ **Vercel** –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞

### Backend (Bot)
- ‚úÖ **Node.js + Telegraf** (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Telegram Bot)
- ‚úÖ **Supabase** (PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ **Vercel** (serverless functions)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebApp ‚Üí Bot –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏

```javascript
// –í WebApp (Svelte)
const sendDataToBot = async (userData) => {
  const response = await fetch('/api/bot/user-data', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': window.Telegram.WebApp.initData
    },
    body: JSON.stringify(userData)
  })
}

// –í Bot (Node.js)
app.post('/api/bot/user-data', (req, res) => {
  const initData = req.headers.authorization
  if (validateTelegramData(initData)) {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –ë–î
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º
  }
})
```

## –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —É—Å–ª—É–≥–∏** –≤ WebApp
2. **WebApp –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ** –±–æ—Ç—É —Å initData –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **Bot –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å** –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram
4. **Bot —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞–∫–∞–∑** –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
5. **Bot —É–≤–µ–¥–æ–º–ª—è–µ—Ç –∞–¥–º–∏–Ω–æ–≤** –æ –Ω–æ–≤–æ–º –∑–∞–∫–∞–∑–µ

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: Bot –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- üíæ **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- üì® **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º
- üöÄ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- üí∞ **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ**: –ú–æ–∂–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö
