<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .admin-link {
            margin: 20px 0;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 10px;
            text-align: center;
        }
        .admin-button {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: transform 0.2s;
        }
        .admin-button:hover {
            transform: scale(1.05);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            background: #333;
            border-radius: 8px;
        }
        button {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            background: #444;
            border-radius: 5px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>üîß –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</h1>
    
    <div class="admin-link">
        <a href="/admin" class="admin-button">üîê –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</a>
        <p>–ö–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–Ω–∞</p>
    </div>

    <div class="test-section">
        <h3>üß™ –¢–µ—Å—Ç API –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥–º–∏–Ω–∞</h3>
        <button onclick="testSuperAdmin()">–¢–µ—Å—Ç —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞ (1155907659)</button>
        <button onclick="testRegularUser()">–¢–µ—Å—Ç –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (123456789)</button>
        <div id="apiResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>üì± –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram</h3>
        <button onclick="simulateUser('1155907659', '–°—É–ø–µ—Ä –ê–¥–º–∏–Ω', 'superadmin')">–°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞</button>
        <button onclick="simulateUser('123456789', '–û–±—ã—á–Ω—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', 'user')">–°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        <div id="simulationResult" class="result"></div>
    </div>

    <script>
        const apiUrl = 'https://tma-webapp-store.netlify.app/.netlify/functions/webhook';

        async function testSuperAdmin() {
            const result = document.getElementById('apiResult');
            result.textContent = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...';
            
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'check_admin',
                        user: { id: '1155907659' }
                    })
                });
                
                const data = await response.json();
                result.textContent = `–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç:\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                result.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            }
        }

        async function testRegularUser() {
            const result = document.getElementById('apiResult');
            result.textContent = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...';
            
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'check_admin',
                        user: { id: '123456789' }
                    })
                });
                
                const data = await response.json();
                result.textContent = `–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:\n${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                result.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            }
        }

        async function simulateUser(userId, firstName, username) {
            const result = document.getElementById('simulationResult');
            result.textContent = '–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤...';
            
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'check_admin',
                        user: { 
                            id: userId,
                            first_name: firstName,
                            username: username
                        }
                    })
                });
                
                const data = await response.json();
                
                result.innerHTML = `
–°–∏–º—É–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- ID: ${userId}
- –ò–º—è: ${firstName}
- Username: ${username}

–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: ${data.isAdmin ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç'}
- –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω: ${data.isSuperAdmin ? 'üëë –î–∞' : '‚ùå –ù–µ—Ç'}

${data.isAdmin ? 'üéâ –ö–Ω–æ–ø–∫–∞ "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å" –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–Ω–∞!' : '‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å" —Å–∫—Ä—ã—Ç–∞'}
                `;
            } catch (error) {
                result.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            }
        }
    </script>
</body>
</html>
